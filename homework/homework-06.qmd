---
title: "Homework - Week 06"
author: "Isabella C. Richmond"
format: html
---

```{r, include = FALSE}
source('R/packages.R')
```

## Question 1: Conduct a prior predictive simulation for the Reedfrog model. By this I mean to simulate the prior distribution of tank survival probabilities αj. Start by using this prior (below). Be sure to transform the αj values to the probability scale for plotting and summary. How does increasing the width of the prior on σ change the prior distribution of αj? You might try Exponential(10) and Exponential(0.1) for example.

$$
\alpha_j \sim Normal(\overline{\alpha}, \sigma)
\\
\overline{\alpha} \sim Normal(0, 1)
\\
\sigma \sim Exponential(1)
$$
To make a prior predictive simulation in `brms`, I can build the model and then sample only from the priors. This just requires me to build the model as I normally would:

```{r, eval=FALSE}
data("reedfrogs")
df <- reedfrogs %>%
  mutate(tank = row_number())

p1_draws <- prior_draws(tar_read(prior_1)) %>%
  mutate(prior = "1",
         Intercept_p = inv_logit_scaled(Intercept))
p01_draws <- prior_draws(tar_read(prior_0.1)) %>%
  mutate(prior = "0.1",
         Intecept_p = inv_logit_scaled(Intercept))
p10_draws <- prior_draws(tar_read(prior_10)) %>%
  mutate(prior = "10",
         Intercept_p = inv_logit_scaled(Intercept))
p100_draws <- prior_draws(tar_read(prior_100)) %>%
  mutate(prior = "100",
         Intercept_p = inv_logit_scaled(Intercept))

draws <- rbind(p1_draws, p10_draws, p100_draws)

ggplot(draws, aes(x = Intercept_p)) +
  geom_density() + 
  theme_classic() + 
  facet_wrap(~ prior)

```

Simulating from the prior 0.1 did not allow the model to succeed because `brms` interprets it as Exponential(0) (which is impossible). When looking at what the Exponential(0.1) prior looks like under this distribution via Richard's homework, we see that all the probability is bunched at either tail. There is no real difference between priors 1-100 for sigma as plotted above.


## Question 2: Revisit the Reedfrog survival data, `data(reedfrogs)`. Start with the varying effects model from the book and lecture. Then modify it to estimate the causal effects of the treatment variables pred and size, including how size might modify the effect of predation. An easy approach is to estimate an effect for each combination of pred and size. Justify your model with a DAG of this experiment.





## Question 3: Now estimate the causal effect of `density` on survival. Consider whether pred modifies the effect of `density`. There are several good ways to include density in your Binomial GLM. You could treat it as a continuous regression variable (possibly standardized). Or you could convert it to an ordered category (with three levels). Compare the σ (tank standard deviation) posterior distribution to σ from your model in Problem 2. How are they different? Why?




## Question 4: Return to the Trolley data, `data(Trolley)`, from Chapter 12. Define and fit a varying intercepts model for these data. By this I mean to add an intercept parameter for the individual participants to the linear model. Cluster the varying intercepts on individual participants, as indicated by the unique values in the `id` variable. Include `action`, `intention`, and `contact` as treatment effects of interest. Compare the varying intercepts model and a model that ignores individuals. What is the impact of individual variation in these data?